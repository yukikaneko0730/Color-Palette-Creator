<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Color Palette Creator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #fdf6ef;
      margin: 0;
      padding: 1rem;
    }
    .card {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
      max-width: 800px;
      margin-left: auto;
      margin-right: auto;
    }
    h2, h3, h4 {
      margin-bottom: 1rem;
      color: #333;
      text-align: center;
    }
    .enhanced-picker {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: none;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      display: block;
      margin: 0 auto;
    }
    .code-display {
      text-align: center;
      font-weight: 600;
      margin-top: 1rem;
    }
    .btn, .btn-outline {
      padding: 0.6rem 1.2rem;
      border-radius: 1rem;
      font-weight: 600;
      cursor: pointer;
      margin: 0.5rem;
    }
    .btn {
      background: #ff8a65;
      color: white;
      border: none;
    }
    .btn-outline {
      border: 2px solid #ff8a65;
      background: transparent;
      color: #ff8a65;
    }
    .color-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
    }
    .color-circle {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      cursor: pointer;
    }
    .color-entry {
      text-align: center;
    }
    .color-entry-code {
      font-size: 0.8rem;
      color: #666;
    }
    .saved-card {
      border: 1px solid #ddd;
      padding: 1rem;
      border-radius: 1rem;
      margin: 1rem 0;
      background: #fff;
    }
    .saved-card-title {
      font-weight: 600;
      margin-bottom: 0.5rem;
      text-align: center;
      cursor: pointer;
    }
    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      text-align: center;
      width: 300px;
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <section class="card">
    <h2>🎨 Color Picker</h2>
    <input type="color" id="color-picker" class="enhanced-picker" />
    <div id="current-color-code" class="code-display">#ffffff</div>
    <button class="btn" id="save-favorite-palette-btn">Save Palette to Favorites</button>
    <button class="btn-outline" id="random-color-btn">🎲 Random Color</button>
    <div id="favorite-palettes" class="color-list"></div>
  </section>

  <section class="card">
    <h2>🎨 Gradient Preview</h2>
    <label for="gradient-angle">Angle (deg):</label>
    <input type="number" id="gradient-angle" value="90" min="0" max="360">
    <div class="gradient-box" id="gradient-box"></div>
    <button class="btn" id="add-to-gradient">＋ Add to Gradient</button>
    <button class="btn-outline" id="clear-gradient">🧹 Clear</button>
    <div id="gradient-color-list" class="color-list"></div>
  </section>

  <div id="palette-rename-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Rename Palette</h3>
      <input type="text" id="palette-rename-input" />
      <button class="btn" id="rename-palette-confirm">Rename</button>
      <button class="btn-outline" id="rename-palette-cancel">Cancel</button>
    </div>
  </div>

  <script>
    const colorPicker = document.getElementById("color-picker");
    const currentColorCode = document.getElementById("current-color-code");
    const saveFavoritePaletteBtn = document.getElementById("save-favorite-palette-btn");
    const favoritePalettesDiv = document.getElementById("favorite-palettes");
    const randomColorBtn = document.getElementById("random-color-btn");
    const gradientBox = document.getElementById("gradient-box");
    const gradientAngleInput = document.getElementById("gradient-angle");
    const gradientColorList = document.getElementById("gradient-color-list");
    const addToGradientBtn = document.getElementById("add-to-gradient");
    const clearGradientBtn = document.getElementById("clear-gradient");
    const paletteRenameModal = document.getElementById("palette-rename-modal");
    const paletteRenameInput = document.getElementById("palette-rename-input");
    const renamePaletteConfirm = document.getElementById("rename-palette-confirm");
    const renamePaletteCancel = document.getElementById("rename-palette-cancel");

    let currentPalette = [];
    let gradientColors = [];
    let favoritePalettes = JSON.parse(localStorage.getItem("favorite-palettes") || "[]");
    let renameTargetIndex = null;

    colorPicker.addEventListener("input", () => {
      const color = colorPicker.value;
      currentColorCode.textContent = color;
      if (!currentPalette.includes(color)) {
        currentPalette.push(color);
      }
    });

    randomColorBtn.onclick = () => {
      const r = Math.floor(Math.random() * 256);
      const g = Math.floor(Math.random() * 256);
      const b = Math.floor(Math.random() * 256);
      const hex = `#${[r, g, b].map(x => x.toString(16).padStart(2, '0')).join('')}`;
      colorPicker.value = hex;
      currentColorCode.textContent = hex;
    };

    saveFavoritePaletteBtn.onclick = () => {
      if (currentPalette.length === 0) return alert("Palette is empty");
      const name = prompt("Enter a name for this palette:");
      if (!name) return;
      favoritePalettes.push({ name, colors: [...currentPalette] });
      localStorage.setItem("favorite-palettes", JSON.stringify(favoritePalettes));
      currentPalette = [];
      renderFavoritePalettes();
    };

    function renderFavoritePalettes() {
      favoritePalettesDiv.innerHTML = "";
      favoritePalettes.forEach((p, index) => {
        const card = document.createElement("div");
        card.className = "saved-card";

        const title = document.createElement("div");
        title.className = "saved-card-title";
        title.textContent = p.name;
        title.onclick = () => openRenamePaletteModal(index, p.name);

        const colorsDiv = document.createElement("div");
        colorsDiv.className = "color-list";

        p.colors.forEach(color => {
          const entry = document.createElement("div");
          entry.className = "color-entry";
          const circle = document.createElement("div");
          circle.className = "color-circle";
          circle.style.backgroundColor = color;
          const code = document.createElement("div");
          code.className = "color-entry-code";
          code.textContent = color;
          entry.appendChild(circle);
          entry.appendChild(code);
          colorsDiv.appendChild(entry);
        });

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "❌";
        deleteBtn.className = "btn-outline";
        deleteBtn.onclick = () => {
          favoritePalettes.splice(index, 1);
          localStorage.setItem("favorite-palettes", JSON.stringify(favoritePalettes));
          renderFavoritePalettes();
        };

        card.appendChild(title);
        card.appendChild(colorsDiv);
        card.appendChild(deleteBtn);
        favoritePalettesDiv.appendChild(card);
      });
    }

    function openRenamePaletteModal(index, currentName) {
      renameTargetIndex = index;
      paletteRenameInput.value = currentName;
      paletteRenameModal.classList.remove("hidden");
    }

    renamePaletteCancel.onclick = () => {
      paletteRenameModal.classList.add("hidden");
    };

    renamePaletteConfirm.onclick = () => {
      const newName = paletteRenameInput.value;
      if (newName) {
        favoritePalettes[renameTargetIndex].name = newName;
        localStorage.setItem("favorite-palettes", JSON.stringify(favoritePalettes));
        renderFavoritePalettes();
      }
      paletteRenameModal.classList.add("hidden");
    };

    addToGradientBtn.onclick = () => {
      const color = colorPicker.value;
      if (!gradientColors.includes(color)) {
        gradientColors.push(color);
        renderGradientColors();
      }
    };

    clearGradientBtn.onclick = () => {
      gradientColors = [];
      renderGradientColors();
    };

    gradientAngleInput.addEventListener("input", renderGradientColors);

    function renderGradientColors() {
      gradientColorList.innerHTML = "";
      gradientColors.forEach((color, index) => {
        const wrapper = document.createElement("div");
        wrapper.className = "color-entry";
        const circle = document.createElement("div");
        circle.className = "color-circle";
        circle.style.backgroundColor = color;
        const code = document.createElement("div");
        code.className = "color-entry-code";
        code.textContent = color;
        const del = document.createElement("button");
        del.textContent = "×";
        del.className = "btn-outline";
        del.onclick = () => {
          gradientColors.splice(index, 1);
          renderGradientColors();
        };
        wrapper.appendChild(circle);
        wrapper.appendChild(code);
        wrapper.appendChild(del);
        gradientColorList.appendChild(wrapper);
      });
      const angle = gradientAngleInput.value || 90;
      gradientBox.style.background = gradientColors.length
        ? `linear-gradient(${angle}deg, ${gradientColors.join(", ")})`
        : "#eee";
    }

    renderFavoritePalettes();
    renderGradientColors();
  </script>
</body>
</html>